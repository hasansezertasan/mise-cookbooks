min_version = "2024.9.5"

[env]
PROJECT_NAME = "{{ config_root | basename }}"
DENO_DIR = ".deno"
ENTRY_FILE = "main.ts"

[tools]
deno = "{{ get_env(name='DENO_VERSION', default='latest') }}"

[tasks.run]
description = "Run the application"
alias = "r"
run = "deno run $ENTRY_FILE"

[tasks.dev]
description = "Run the application with watch mode"
alias = "d"
run = "deno run --watch $ENTRY_FILE"

[tasks.test]
description = "Run tests"
alias = "t"
run = "deno test"

[tasks.lint]
description = "Lint the code"
alias = "l"
run = "deno lint"

[tasks.format]
description = "Format the code"
alias = "f"
run = "deno fmt"

[tasks.check]
description = "Type-check the code"
alias = "c"
run = "deno check $ENTRY_FILE"

[tasks.compile]
description = "Compile to a standalone executable"
run = "deno compile $ENTRY_FILE"

[tasks.cache]
description = "Cache dependencies (uses deno.json imports)"
run = "deno cache $ENTRY_FILE"

[tasks.bench]
description = "Run benchmarks"
run = "deno bench"

[tasks.doc]
description = "Generate documentation"
run = "deno doc $ENTRY_FILE"

[tasks.ci]
description = "Run all checks (lint, check, test)"
depends = ["lint", "check", "test"]

[tasks.info]
description = "Print project information"
run = '''
echo "Project: $PROJECT_NAME"
echo "Deno: $(deno --version | head -1)"
'''
